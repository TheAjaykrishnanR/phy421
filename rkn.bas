100 DIM A(4),G(4,4),W(4),X(4):W(1) = W(4) = 1/6:W(2)= W(3)=1/3
110 DEF FNF(T,X1,X2,X3,X4)= -4*SIN(T)-X1-X2-X3+4*X4+X4*(X4-X3+X2-X1)
120 DEF FNQ(Z) = Z
130 INPUT"t0,n,h,kmax";T,N,H,KM
140 FOR I=1 TO N-1: PRINT "INPUT D";I;"(X)":INPUT X(N-I):NEXT I
150 FOR K=1 TO KM
160 PRINT T;X(N);EXP(T)+SIN(T)
170 FOR I=1 TO 4: FOR J=1 TO N
180 P=.5:IF I=1 THEN P=0: IF I=4 THEN P=1
190 IF J > 1 THEN G(I,J) = FNQ(X(J-1))
200 X(J)=X(J)+H*W(I)*G(I,J)
210 A(J)=X(J)+P*H*G(I,J)
220 NEXT J
230 G(I,1)=FNF(T+P*H,A(1),A(2),A(3),A(4))
240 NEXT I:T = T + H:NEXT K: END